{"ast":null,"code":"var express = require(\"express\");\nvar cors = require(\"cors\");\nvar app = express();\nvar port = 3001;\napp.use(cors());\nvar vehicle_infoModel = require(\"./vehicle_infoModel\");\nvar personal_infoModel = require(\"./personal_infoModel\");\napp.use(express.json());\napp.use(function (req, res, next) {\n  res.setHeader(\"Access-Control-Allow-Origin\", \"http://localhost:19006\");\n  res.setHeader(\"Access-Control-Allow-Methods\", \"GET,POST,PUT,DELETE,OPTIONS\");\n  res.setHeader(\"Access-Control-Allow-Headers\", \"Content-Type, Access-Control-Allow-Headers\");\n  next();\n});\napp.get(\"/personal_info\", function (req, res) {\n  personal_infoModel.getPersonalInfo().then(function (personalInfo) {\n    var query = req.query.q;\n    if (query) {\n      personalInfo = personalInfo.filter(function (info) {\n        return info.owner_name.toLowerCase().includes(query.toLowerCase());\n      });\n    }\n    res.status(200).send(personalInfo);\n  }).catch(function (error) {\n    console.error(\"Error fetching personal info:\", error);\n    res.status(500).send(error);\n  });\n});\napp.get(\"/\", function (req, res) {\n  vehicle_infoModel.getVehicleInfo().then(function (vehicleInfo) {\n    var query = req.query.q;\n    if (query) {\n      vehicleInfo = vehicleInfo.filter(function (info) {\n        return info.registration_number.toLowerCase().includes(query.toLowerCase());\n      });\n    }\n    res.status(200).send(vehicleInfo);\n  }).catch(function (error) {\n    console.error(\"Error fetching vehicle info:\", error);\n    res.status(500).send(error);\n  });\n});\napp.post(\"/vehicle_info\", function (req, res) {\n  vehicle_infoModel.createVehicleInfo(req.body).then(function (response) {\n    res.status(200).send(response);\n  }).catch(function (error) {\n    res.status(500).send(error);\n  });\n});\napp.delete(\"/vehicle_info/:registrationNumber\", function (req, res) {\n  vehicle_infoModel.deleteVehicleInfo(req.params.registrationNumber).then(function (response) {\n    res.status(200).send(response);\n  }).catch(function (error) {\n    res.status(500).send(error);\n  });\n});\napp.listen(port, function () {\n  console.log(`App running on port ${port}.`);\n});","map":{"version":3,"names":["express","require","cors","app","port","use","vehicle_infoModel","personal_infoModel","json","req","res","next","setHeader","get","getPersonalInfo","then","personalInfo","query","q","filter","info","owner_name","toLowerCase","includes","status","send","catch","error","console","getVehicleInfo","vehicleInfo","registration_number","post","createVehicleInfo","body","response","delete","deleteVehicleInfo","params","registrationNumber","listen","log"],"sources":["/home/mbulelo/IVDLMS/Vehicle_Licensing/backend/index.js"],"sourcesContent":["const express = require(\"express\");\nconst cors = require(\"cors\");\nconst app = express();\nconst port = 3001;\n\napp.use(cors()); // Enable CORS for all routes\nconst vehicle_infoModel = require(\"./vehicle_infoModel\"); // Updated import statement\nconst personal_infoModel = require(\"./personal_infoModel\"); // Import personal_infoModel\n\napp.use(express.json());\napp.use(function (req, res, next) {\n  res.setHeader(\"Access-Control-Allow-Origin\", \"http://localhost:19006\");\n  res.setHeader(\"Access-Control-Allow-Methods\", \"GET,POST,PUT,DELETE,OPTIONS\");\n  res.setHeader(\n    \"Access-Control-Allow-Headers\",\n    \"Content-Type, Access-Control-Allow-Headers\"\n  );\n  next();\n});\n\n\n\n// Routes for personal_info\napp.get(\"/personal_info\", (req, res) => {\n  personal_infoModel\n    .getPersonalInfo()\n    .then((personalInfo) => {\n      const query = req.query.q;\n      if (query) {\n        personalInfo = personalInfo.filter((info) =>\n          info.owner_name.toLowerCase().includes(query.toLowerCase())\n        );\n      }\n      res.status(200).send(personalInfo);\n    })\n    .catch((error) => {\n      console.error(\"Error fetching personal info:\", error);\n      res.status(500).send(error);\n    });\n});\n\n\n\n\napp.get(\"/\", (req, res) => {\n  vehicle_infoModel // Updated model function call\n    .getVehicleInfo()\n    .then((vehicleInfo) => {\n      // Extract the search query from request query parameters\n      const query = req.query.q;\n\n      // If there's a search query, filter vehicle info based on it\n      if (query) {\n        vehicleInfo = vehicleInfo.filter((info) =>\n          info.registration_number.toLowerCase().includes(query.toLowerCase())\n        );\n      }\n\n      res.status(200).send(vehicleInfo);\n    })\n    .catch((error) => {\n      console.error(\"Error fetching vehicle info:\", error);\n      res.status(500).send(error);\n    });\n});\n\n\napp.post(\"/vehicle_info\", (req, res) => { // Updated endpoint route\n  vehicle_infoModel // Updated model function call\n    .createVehicleInfo(req.body)\n    .then((response) => {\n      res.status(200).send(response);\n    })\n    .catch((error) => {\n      res.status(500).send(error);\n    });\n});\n\napp.delete(\"/vehicle_info/:registrationNumber\", (req, res) => { // Updated endpoint route\n  vehicle_infoModel // Updated model function call\n    .deleteVehicleInfo(req.params.registrationNumber)\n    .then((response) => {\n      res.status(200).send(response);\n    })\n    .catch((error) => {\n      res.status(500).send(error);\n    });\n});\n\napp.listen(port, () => {\n  console.log(`App running on port ${port}.`);\n});\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}